# 版本历史

本文档记录了 BaiduPCS-Rust 的所有版本更新历史。

## v1.5.1 (当前版本)

**问题修复：**
- 🐛 修复若干 bug

**功能改进：**
- ✨ 系统页面选择下载目录支持文件资源管理器

---

## v1.5.0

**主要功能：**
- ✨ **任务持久化**：新增 WAL + 元数据的持久化管理器，支持后台批量刷写、断点恢复与优雅关闭（下载/上传/转存任务重启可恢复）
- ✨ **移动端适配**：主布局新增移动端抽屉导航与底部 Tab 栏，响应式样式覆盖文件/下载/上传/转存/设置页
- ✨ **日志持久化与滚动**：支持日志文件落盘、按大小滚动和保留天数配置，默认启用
- ✨ **任务槽机制**：下载引入任务槽（固定位+借调位）机制，替代预注册机制，保证并发可控
- ✨ **WebSocket 实时推送**：任务状态可实时刷新

---

## v1.4.0

**主要功能：**
- ✨ **转存分享链接功能**：支持转存百度网盘分享链接到自己的网盘，支持提取码验证，可选择转存后自动下载
- ✨ **CDN链接刷新三层检测机制**：
    - 显著提升下载稳定性和速度
- ✨ **批量上传和批量下载**：支持在文件管理页面多选文件/文件夹进行批量操作
- ✨ **下载文件资源管理器**：下载时可通过文件资源管理器选择保存目录，支持最近目录记忆
- ✨ **上传下载最近目录功能**：自动记录最近使用的上传/下载目录，下次操作时自动定位
- ✨ **统一上传按钮**：上传文件和上传文件夹使用同一个按钮，简化操作流程

**问题修复：**
- 🐛 **修复下载文件夹暂停问题**：修复了下载文件夹时暂停操作，子文件仍在继续下载的问题

**技术改进：**
- 🧩 后端新增 `transfer` 模块，实现分享链接解析、验证和转存功能
- 🧩 后端新增 三层检测机制
- 🧩 优化下载引擎，集成CDN链接自动刷新机制，提升下载稳定性
- 🧩 前端优化 FilePicker 组件，支持下载目录选择模式
- 🧩 前端优化 FilesView，支持批量选择和批量操作

---

## v1.3.1

**问题修复：**
- 🐛 **修复系统设置页面下载路径不生效问题**：在系统设置中修改下载路径后，现在会立即动态更新下载管理器和文件夹下载管理器的下载目录，无需重启应用即可生效
- 🔧 **优化健康检查配置**：调整 Docker 健康检查参数

**技术改进：**
- 🧩 在配置更新 API 中增加动态更新下载目录的逻辑，确保配置修改后立即生效
- 🧩 优化下载管理器和文件夹下载管理器的下载目录更新机制，支持运行时动态切换

---

## v1.3.0

**主要功能：**
- ✨ **上传引擎与上传任务管理页面**：支持查看全部上传任务、进度、速度和剩余时间
- ✨ **集成本地文件资源管理器**：用于选择本地文件或文件夹作为上传源，支持路径导航与分页加载
- ✨ **上传任务控制**：支持暂停、继续、重试和删除操作，并在支持秒传的场景下显示"秒传"状态
- ✨ **百度网盘新建文件夹功能**：支持在网盘中创建新文件夹（⚠️ 可能需要重新登入才可使用）

**前后端改进：**
- 🧩 后端新增 `uploader` 模块与本地文件系统访问模块，负责上传任务的调度与状态管理
- 🧩 前端新增 `上传管理` 页面与 `FilePicker` 组件，并与文件管理页面打通"上传"入口

**文档与截图更新：**
- 📝 更新 README 增加上传相关功能说明与界面预览
- 🖼️ 新增上传管理、文件上传对话框、上传设置等界面截图

---

## v1.2.1

**性能优化：**
- 🚀 **并发优化**：重构热点访问路径，消除锁竞争瓶颈，提升多任务场景下的吞吐
- ⚖️ **动态加权分片调度**：根据实时带宽与分片健康度自适应调度，显著提升下载平滑度

**稳定性增强：**
- 🔁 **重试指数退避**：失败重试采用指数退避 + 抖动策略，降低瞬时失败放大效应
- 🧠 **任务级并发控制**：为单任务设置细粒度并发上限，避免少量大任务占用全部资源

---

## v1.2.0

**主要功能：**
- ✨ **文件夹下载功能**：支持递归下载整个文件夹，自动扫描并创建所有文件的下载任务
- ✨ **混合任务列表**：文件和文件夹下载任务统一显示，支持聚合进度显示

**优化改进：**
- 🚀 **URL淘汰策略优化**：
    - 实现 LinkState 权重结构，智能管理下载链接
    - 使用 score 评分机制（0-100）评估链接健康状态
    - 速度追踪双轨制：短期窗口 median + EWMA 长期统计
    - 优化 chunk 下载完成逻辑，使用 lazy probe 机制
    - 显著提升下载平滑度和稳定性

**文档更新：**
- 📝 完善 README 配置说明，添加普通用户和 SVIP 配置建议

---

## v1.1.1

**问题修复：**
- 🐛 优化下载调度器，修复下载速度慢的问题

**其他：**
- 🧹 移除未使用的 docker-build.yml workflow 文件

---

## v1.1.0

**配置功能优化：**
- ✅ **强制使用绝对路径**：下载目录从相对路径改为必须使用绝对路径
    - 配置文件验证：保存配置时验证下载目录是否为绝对路径
    - 路径格式检查：Windows 示例 `D:\Downloads`，Linux/Docker 示例 `/app/downloads`
    - 自动路径解析：默认配置会根据运行环境（Docker/本地）自动生成绝对路径

- ✅ **路径验证增强**：新增完整的路径验证功能
    - 新增 `PathValidator` 模块：验证路径存在性、可写性、可用空间
    - 新增 `EnvDetector` 模块：检测运行环境（Docker/本地、操作系统类型）
    - 新增 `MountDetector` 模块：检测挂载点信息
    - 保存配置前进行完整验证，确保路径可用

- ✅ **配置功能优化**：
    - 改进配置加载逻辑，自动验证路径格式
    - 保存配置时返回详细的路径验证结果
    - 首次启动时自动创建默认下载目录（如果不存在）
    - 优化错误提示，提供清晰的路径格式说明

**前端界面改进：**
- ✅ **设置页面优化**：
    - 更新下载目录配置说明，明确要求使用绝对路径
    - 改进错误提示信息，显示路径格式要求
    - 增强下载目录配置的用户体验

**下载器改进：**
- ✅ **下载管理器优化**：
    - 改进日志输出，显示下载目录路径
    - 优化目录创建逻辑和日志提示

**问题修复：**
- 🐛 修复 mount detector vector 类型注解问题

**文档：**
- 📝 添加贡献指南并优化配置功能说明

---

## v1.0.0

**初始版本发布：**
- ✨ 基础架构搭建
- ✨ 二维码扫码登录功能
- ✨ 文件浏览和管理
- ✨ 单文件下载引擎（多线程 + 断点续传）
- ✨ Web 服务器（RESTful API）
- ✨ 前端界面（Vue 3 + Element Plus）
- ✨ Docker 部署支持

